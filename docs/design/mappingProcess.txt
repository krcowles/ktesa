HIKE MAP PAGE CREATION & DISPLAY

There are essentially three types of map displays:
	1. Map with pins locating hikes (map w/table, or full-pg map);
	2. Maps appearing in an iframe on the individual hike page;
	3. Full page versions of #2, when a link on the hike page is clicked.
	
This document will address No's 2 & 3.

For the individual hike pages, the maps are 'created' on the fly using the 
GPSVisualizer.com site document filled in with details specific to the hike of interest.
The iframe (2.) and the full-page link (3.) are both formulated in either the
'hikePageTemplate.php', or during page creation: 'displayHikePg.php'.
To simplify implementation for display in the iframe, the GPSV map is saved in a 
temporary directory and then removed when the page is exited. Currently that location 
is  project/maps/tmp/. For full-page links, no temporary file is stored: instead,
parameters are supplied which will allow the template to create the map independently.
In this way, the link could be copied & pasted or sent to another individual without
requiring invocation of the project.

The work of creating the html for the map, which is then included in the iframe or by
the link, is done in the routine: project/php/makeGpsv.php.
This routine 'expects' certain variables to have been pre-established in the calling
routing:
	- $hikeTitle	Name displayed referencing the subject hike;
	- $usetsv		IF FALSE: derive from the database, or supply 
					- $photos xml object ($db->tsv)
					IF TRUE: supply
					- $gpsvFile     (a fname.tsv file containing photo locs & links)'
	- $gpxfile		The hike's .gpx (.GPX) track file
	
* ------------------------------------------------------------------------------------ *
NOTES:
	1. Newer hikes are being implemented using <picDat> nodes in the <tsv> section
of the xml database, so the routine needs to establish whether to use the tsv file or
the <picDat> tags. To do this is a simple matter of loading the xml database to look
for the existence of a tsv file (tag: <file>) in the <tsv> section. If not present, the 
database will look for <picDat> tags which hold the required information (same data as
present in tsv file). Hence, prior to invoking the makeGpsv.php routine, establish
the source for photo information ($usetsv = true/false).
	2. Displayed iframe maps & full-page links will also appear when creating a new
hike page, before the data is actually saved to the database. In the enterHike.html
script, the user may opt not to use photos at this time: checkbox 'nopix'. In the
script 'validateHike.php', the imported checkbox, if checked, will determine whether
the xml database gets loaded with tsv (photo) data. If not checked, this process will 
be skipped, hence no map photos will appear either. This option status is passed on to
'displayHikePg.php' as 'usepics', which will then determine whether or not to attempt
to display photos on the hike page. Remember, no tsv data has been entered into the
database at this time, so 'makeGpsv.php' should not attempt to create map photos.
* ------------------------------------------------------------------------------------ *

The map display (iframe or full-page link) is carried out by the routine 
'gpsvMapTemplate.php'. This script will check to see if the call is for the full-page
link (in which case the map_name is set to 'MapLink'), or within the iframe. If for the
iframe, the data already exists in the tmp file noted above, and the template need only
load in the existing tmp/html file. In the case of a full-page map link, in order to be 
able to utilize this link independently of a tmp map (e.g. copy link and send to friend),
the makeGpsv.php script needs to be invoked with the appropriate options, i.e. "tsv=NO".
In this case, the xml database is loaded, and the expected $photos option is supplied
for the script.

